<template lang="pug">
.section.section-collab(
  ref="maskWrapper"
)

  .container.flex.flex-col.items-center
    .section-title
      span äº†è§£æˆ‘çš„
      span.green è‡ªç”±èŒä¸š
      span å·¥ä½œæµ
    .section-desc è‡ªä» 2018 å¹´å¼€å§‹è¿œç¨‹å·¥ä½œï¼Œå®ç°äº†åªå·¥ä½œä¸ä¸Šç­ã€‚åœ¨åˆ›ä¸šå…¬å¸æˆ‘ä»¬ç”¨ç®€æ´ä¸”é€æ˜çš„åä½œæ–¹å¼æ¥æé«˜æ•ˆç‡ï¼Œåˆ©ç”¨èŠ‚çœä¸‹æ¥çš„æ—¶é—´æˆ‘å»äº†å¾ˆå¤šåœ°æ–¹æ¸¸ç©ï¼Œå­¦äº†å¾ˆå¤šèˆ’é€‚åœˆä»¥å¤–çš„ä¸œè¥¿ã€‚å¸Œæœ› 24 å¹´å¼€å§‹åˆ©ç”¨å‰¯ä¸šåˆ›é€ å¾ˆå¤šæ”¶å…¥ã€‚

  mask-scan-reveal.container(
    :progress="store.ui.collabScrollProgress"
  )
    .flex.flex-col.items-center
      .workflow-list.flex.flex-col.items-center
        //-  @TODO: æ”¯æŒåŠ¨æ€å®šä½
        .dom-arrows(
          v-if="!$device.isMobile"
        )
          .arrow.arrow-req-to-schedule
            nuxt-icon.arrow-marker(
              name="down-arrow"
            )
          .arrow.arrow-schedule-to-develop
            nuxt-icon.arrow-marker(
              name="down-arrow"
            )
          .arrow.arrow-develop-to-deliver
            nuxt-icon.arrow-marker(
              name="down-arrow"
            )
        workflow-item.workflow-req(
          themeColor="#aec9d7"
          title="1. æ ¹æ®è®¾è®¡ç¨¿å’Œ PRD ç¡®è®¤éœ€æ±‚"
          iconEmoji="ğŸ“–"
        )
          | æœ€ç†æƒ³çš„å¼€å±€æ˜¯å®¢æˆ·æœ‰ä¸€ä¸ªä»½
          icon-link(
            iconName="figma"
            href="https://figma.com"
          ) Figma
          | è®¾è®¡ç¨¿ï¼Œè¿™æ ·èƒ½ç¡®ä¿æˆ‘å¯¹éœ€æ±‚æœ‰æœ€ç›´è§‚çš„ç†è§£ï¼Œè¿˜èƒ½é¿å…åƒ
          icon-link(
            iconName="sketch"
            href="https://www.sketch.com"
          ) Sketch
          | åŒæ­¥å›°éš¾ã€‚æœ‰ä¸€äº›é€»è¾‘/äº¤äº’åœ¨ UI ç¨¿ä¸Šæ— æ³•ä½“ç°ï¼Œå¯ä»¥é¢å¤–åœ¨
          icon-link(
            iconName="notion"
            href="https://www.notion.so"
          ) Notion
          | ä¸Šæä¾› PRDã€‚<br/><br/>

          | åœ¨éœ€æ±‚æ–‡æ¡£ Ready åï¼Œæˆ‘ä¼šå’Œå®¢æˆ·æ‹‰ä¸€ä¸ª
          icon-link(
            iconName="feishu"
            href="https://www.feishu.cn"
          ) é£ä¹¦ä¼šè®®
          | åšéœ€æ±‚è¯„å®¡ï¼Œæå‡ºç–‘æƒ‘çš„åœ°æ–¹ã€‚ç¡®å®šæŠ€æœ¯æ–¹æ¡ˆä»¥åŠå¯è¡Œæ€§ã€‚

        workflow-item.workflow-schedule(
          themeColor="#c4886f"
          width="540px"
          title="2. åšå‡ºä¼°æ—¶ä¸æŠ¥ä»·"
          iconEmoji="ğŸ•°"
        )
          | åœ¨éœ€æ±‚è¯„å®¡é€šè¿‡åä¸ä¼šç«‹åˆ»è¿›å…¥è¿­ä»£ï¼Œæˆ‘ä¼šèŠ± 1-2 å¤©æ—¶é—´åšä»»åŠ¡æ‹†åˆ†å’Œæ’æœŸã€‚ä»»åŠ¡ä¼šè€ƒè™‘å…¨å‘¨æœŸï¼š
          ol
            li é¡¹ç›®æ¶æ„ï¼Œç¡®ä¿èƒ½æ”¯æ’‘äº§å“
            li åŠŸèƒ½è¿­ä»£ï¼Œå¯¹ä¸šåŠ¡é€»è¾‘è§£æ„ä¸å®ç°
            li ä¸Šæ¸¸è”è°ƒï¼Œæ¶‰åŠåˆ°åç«¯æˆ–è€…ç¬¬ä¸‰æ–¹æ¥å£
            li æµ‹è¯•ä¼˜åŒ–ï¼Œå°¤å…¶æ˜¯å“åº”å¼ï¼Œä¸åŒç¯å¢ƒä¸‹çš„å…¼å®¹æ€§
            li éƒ¨ç½²ä¸Šçº¿ï¼Œè§¦è¾¾ç”¨æˆ·

          | æˆ‘ä¼šåˆ›å»ºä¸€ä¸ªè¡¨æ ¼ï¼Œå¯¹æ¯ä¸€ä¸ªä»»åŠ¡åšè€—æ—¶é¢„ä¼°ï¼Œè¿™æ ·å°±èƒ½å¾—å‡ºæ’æœŸå’ŒæŠ¥ä»·æ–¹æ¡ˆã€‚ç›®å‰æˆ‘ä¸€ä¸ªå·¥ä½œæ—¥æ”¶è´¹æ˜¯
          icon-link(
            iconName="exchange-cny-line"
          ) {{ costPerDay }} CNY
          | ï¼Œç­‰å€¼çš„ç¾å…ƒæˆ–æ•°å­—è´§å¸ä¹Ÿæ˜¯å¯æ¥å—çš„ã€‚å‡è®¾ä¸€ä¸ªéœ€æ±‚è€—æ—¶ 10 ä¸ªå·¥ä½œæ—¥ï¼ŒæŠ¥ä»·åˆ™ä¸º
          | <code>{{costPerDay}} * 10 = {{ costPerDay * 10 }} CNY</code>

        workflow-item.workflow-develop(
          title="3. è¾¾æˆå…±è¯†ï¼Œå¼€å§‹è¿­ä»£"
          themeColor="#b99220"
          width="700px"
          iconEmoji="ğŸ‘¨â€ğŸ’»"
        )
          | åœ¨åˆ¶å®šæ’æœŸå’ŒæŠ¥ä»·æ–¹æ¡ˆæ—¶ï¼Œæˆ‘ä¹Ÿä¼šä¸å®¢æˆ·è¿›è¡Œå……åˆ†çš„æ²Ÿé€šå’Œåå•†ï¼Œä»¥ç¡®ä¿åŒæ–¹è¾¾æˆå…±è¯†ã€‚<br/>
          | åœ¨å½¢æˆå…±è¯†åï¼Œæˆ‘ä¼šåœ¨
          icon-link(
            iconName="github"
            href="https://github.com"
          ) GitHub
          | ä¸Šåˆ›å»ºä¸€ä¸ªç§æœ‰é¡¹ç›®ï¼Œå¹¶éƒ¨ç½²åˆ°
          icon-link(
            iconName="file-type-light-vercel"
            href="https://vercel.com"
          ) Vercel
          | ä¸Šã€‚<br/><br/>
          | æ¥ä¸‹æ¥æ˜¯æŒ‰ç…§è®¡åˆ’è¿›è¡Œè¿­ä»£ã€‚æˆ‘ä¼šåœ¨
          icon-link(
            iconName="slack"
            href="https://slack.com"
          ) Slack
          | æˆ–
          icon-link(
            iconName="wechat"
            href="https://www.wechat.com"
          ) å¾®ä¿¡
          | ä¸å®¢æˆ·è¿›è¡Œæ²Ÿé€šå’Œåé¦ˆã€‚è¿™æ ·å¯ä»¥ç¡®ä¿é¡¹ç›®åœ¨å¼€å‘è¿‡ç¨‹ä¸­çš„çµæ´»æ€§å’ŒåŠæ—¶è°ƒæ•´ã€‚

        workflow-item.workflow-deliver(
          title="4. æŒç»­äº¤ä»˜ä¸æ‰“ç£¨"
          themeColor="#3de157"
          iconEmoji="ğŸ€"
        )
          | å½“é¡¹ç›®çš„å¼€å‘å·¥ä½œå®Œæˆåï¼Œæˆ‘ä¼šè¿›è¡Œä»£ç æ¢³ç†å’Œè‡ªæµ‹ã€‚è‡ªæµ‹é€šè¿‡åä¼šéƒ¨ç½²ä¸€ä¸ªç¨³å®šçš„ Staging ç¯å¢ƒç»™å®¢æˆ·è¿›è¡Œæµ‹è¯•ï¼Œæ ¹æ®å®¢æˆ·çš„åé¦ˆä½œå‡ºå¿…è¦çš„æ‰“ç£¨å’Œä¿®å¤ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼š
          icon-link(
            iconName="loop"
          ) å¾ªç¯å¤šæ¬¡
          | ç›´åˆ°éªŒæ”¶é€šè¿‡ã€‚<br/><br/>
          | æ¥ä¸‹æ¥æ˜¯æŠŠé¡¹ç›®éƒ¨ç½²åˆ°çº¿ä¸Šå¹¶ç»‘å®šåŸŸåï¼Œè®©ç”¨æˆ·ä½“éªŒæˆ‘ä»¬çš„æˆæœ ğŸ‰ã€‚æœ€åæˆ‘ä¼šç»™å®¢æˆ·ä¸€ä¸ª
          icon-link(
            iconName="money-bag"
          ) æ”¶æ¬¾æ–¹å¼
          | ï¼Œæ”¯ä»˜æˆ‘ç›¸åº”çš„æŠ¥é…¬ã€‚æˆ‘ä¼šç»™é¡¹ç›®æä¾›é•¿æœŸå”®åï¼Œä¸ºå¤šæ¬¡åˆä½œæ‰“ä¸‹åŸºç¡€ã€‚

        workflow-item.workflow-tips(
          width="700px"
          title="é™¤å‰ç«¯ä¹‹å¤–ï¼Œæ›´å…¨é¢çš„åˆä½œ"
          themeColor="#808080"
          iconEmoji="ğŸ‘"
        )
          | å¦‚æœå®¢æˆ·æ‹¥æœ‰ <b>ğŸ’¡ Idea</b>ï¼Œæƒ³è¦å®Œæ•´çš„äº§å“å›¢é˜Ÿã€‚æˆ‘å¯ä»¥ä»‹ç»ä¸æˆ‘åˆä½œå¤šå¹´çš„ <b>è§†è§‰è®¾è®¡å¸ˆã€åç«¯ã€åˆçº¦ã€ç®—æ³•ã€è¿ç»´å·¥ç¨‹å¸ˆ</b> ä¸€èµ·ï¼Œå¸®åŠ©å®¢æˆ·æŠŠæƒ³æ³•è½åœ°ã€‚
          | <br/><br/>
          | æƒ³è¦äº†è§£æ›´å¤šï¼Ÿæ¬¢è¿é˜…è¯»ã€Š
          icon-link(
            iconName="notebook-agenda"
            :href="PATH.coCreateManual"
          ) &nbsp;ä¸èˆ’ä¹ç†Šä¸€èµ·å¿«ä¹åä½œæ‰‹å†Œ.pdf
          | ã€‹

</template>

<script lang="ts" setup>
import { ScrollTrigger } from 'gsap/ScrollTrigger'
import { useResizeObserver } from '@vueuse/core'
import { PATH } from '@/utils/const'

const store = useStore()
const { isMobile } = useDevice()
const costPerDay = ref(1600)
const maskWrapper = ref()

const setupResize = () => {
  // åŒæ­¥ trigger å’Œ content çš„é«˜åº¦ï¼Œç„¶åé€šçŸ¥ ScrollTrigger
  useResizeObserver(maskWrapper.value, async (entries) => {
    const entry = entries[0]
    store.ui.collabHeight = entry.contentRect.bottom
    await nextTick()
    ScrollTrigger.refresh()
  })
}

// @FIXME: éœ€è¦è§£å†³æ»šåŠ¨åçš„å®šä½é—®é¢˜
const setupLeaderLine = async () => {
  if (isMobile) return
  const { default: LeaderLine } = await import('leader-line-new')
  const lineStyle = {
    color: '#ccc',
    size: 1
  }
  const line1 = new LeaderLine({
    start: document.querySelector('.workflow-req') as Element,
    end: document.querySelector('.workflow-schedule') as Element,
    ...lineStyle
  })
  const line2 = new LeaderLine({
    start: document.querySelector('.workflow-schedule') as Element,
    end: document.querySelector('.workflow-develop') as Element,
    ...lineStyle
  })

  Array.from(document.querySelectorAll('.leader-line')).map(el => {
    document.querySelector('.content-wrapper')?.appendChild(el)
  })

  watch(() => store.ui.contentScrollProgress, () => {
    line1.position()
    line2.position()
  })
}

const setupArrows = async () => {
  if (isMobile) return
}

onMounted(() => {
  setupResize()
  // setupLeaderLine()
  setupArrows()
})
</script>

<style lang="stylus">
.leader-line
  z-index: 20
  // transform: translate3d(0, -270px, 0)

.section-collab
  padding: 0 20px
  padding-top: 16vh
  padding-bottom: 8vh

  @media $mediaInMobile
    padding-top: 8vh

  .arrow
    position absolute

    .arrow-marker
      position absolute

  .arrow-req-to-schedule
    left: 400px
    top: 150px
    width: 100px
    height: 180px
    color: #ccc
    border-top: 1px solid currentColor
    border-right: 1px solid currentColor

    .arrow-marker
      right: 0
      bottom: 0
      transform: translate3d(50%, 80%, 0)

  .arrow-schedule-to-develop
    left: 60px
    top: 560px
    width: 100px
    height: 210px
    color: #ccc
    border-left: 1px solid currentColor
    border-top: 1px solid currentColor

    .arrow-marker
      left: 0
      bottom: 0
      transform: translate3d(-50%, 80%, 0)

  .arrow-develop-to-deliver
    left: 340px
    top: 1023px
    width: 0px
    height: 30px
    color: #64eb79
    border-left: 1px solid currentColor

    .arrow-marker
      left: 0
      bottom: 0
      transform: translate3d(-50%, 75%, 0)

  .container
    max-width: 880px
    margin: 0 auto

  .section-title
    font-size: fluid-value(30, 50)
    margin-bottom: fluid-value(20, 32)
    color: rgba(0, 0, 0, 0.2)
    -webkit-text-stroke: fluid-value(0.5, 1) black

    .green
      color: brand(20)

  .section-desc
    font-size: fluid-value(16, 22)
    opacity: 0.8
    max-width: 1100px
    text-align: center
    margin-bottom: fluid-value(42, 60)

  .workflow-list
    max-width: 1000px
    position relative

    .workflow-req
      align-self: flex-start

    .workflow-tips
      @media (min-width: 1000px)
        margin-top: 100px

      b
        font-weight: 500
        color: $primary100

    .workflow-deliver,
    .workflow-develop
      .workflow-emoji
        transform: scale(0.9)

    .workflow-schedule
      align-self: flex-end

      .workflow-emoji
        transform: scale(0.83)

    .link-notion,
    .link-money-bag,
    .link-exchange-cny-line
      .nuxt-icon
        position relative
        top: -1px
</style>
